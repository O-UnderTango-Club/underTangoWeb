{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ginos/Desktop/PRODUCTION/underTangoWeb/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);"],"names":[],"mappings":";;;;AAEoB;AAFpB;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,0LAAY,EAAC,aAAa"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ginos/Desktop/PRODUCTION/underTangoWeb/app/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { supabase } from \"../../src/lib/supabase\";\r\nimport { Session, AuthChangeEvent } from \"@supabase/supabase-js\";\r\n\r\ninterface AuthContextProps {\r\n  user: any;\r\n  loading: boolean;\r\n  login: (email: string, password: string) => Promise<any>;\r\n  register: (data: RegisterPayload) => Promise<any>;\r\n  logout: () => Promise<void>;\r\n  updatePassword: (newPassword: string) => Promise<any>; // ‚Üê agregado\r\n}\r\n\r\ninterface RegisterPayload {\r\n  email: string;\r\n  password: string;\r\n  first_name?: string;\r\n  last_name?: string;\r\n  username?: string;\r\n  phone?: string;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextProps | null>(null);\r\n\r\nexport const AuthProvider = ({ children }: { children: React.ReactNode }) => {\r\n  const [user, setUser] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Cargar sesi√≥n al iniciar\r\n  useEffect(() => {\r\n    const getSession = async () => {\r\n      const { data } = await supabase.auth.getSession();\r\n      setUser(data.session?.user ?? null);\r\n      setLoading(false);\r\n    };\r\n\r\n    getSession();\r\n\r\n    // Escuchar cambios en la sesi√≥n\r\n    const { data: listener } = supabase.auth.onAuthStateChange(\r\n      (_event: AuthChangeEvent, session: Session | null) => {\r\n        setUser(session?.user ?? null);\r\n      }\r\n    );\r\n\r\n    return () => listener.subscription.unsubscribe();\r\n  }, []);\r\n\r\n  // LOGIN\r\n  const login = async (email: string, password: string) => {\r\n    const { data, error } = await supabase.auth.signInWithPassword({\r\n      email,\r\n      password,\r\n    });\r\n\r\n    if (error) {\r\n      return { success: false, message: error.message };\r\n    }\r\n\r\n    return { success: true, user: data.user };\r\n  };\r\n\r\n  // REGISTER\r\n  const register = async ({\r\n    email,\r\n    password,\r\n    first_name,\r\n    last_name,\r\n    username,\r\n    phone,\r\n  }: RegisterPayload) => {\r\n    const { data, error } = await supabase.auth.signUp({\r\n      email,\r\n      password,\r\n      options: {\r\n        data: {\r\n          first_name,\r\n          last_name,\r\n          phone: phone || undefined,\r\n        },\r\n      },\r\n    });\r\n\r\n    if (error) {\r\n      return { success: false, message: error.message };\r\n    }\r\n\r\n    return { success: true, user: data.user };\r\n  };\r\n\r\n  // UPDATE PASSWORD\r\n  const updatePassword = async (newPassword: string) => {\r\n    const { data, error } = await supabase.auth.updateUser({\r\n      password: newPassword,\r\n    });\r\n\r\n    if (error) {\r\n      return { success: false, message: error.message };\r\n    }\r\n\r\n    return { success: true, user: data.user };\r\n  };\r\n\r\n  // LOGOUT\r\n  const logout = async () => {\r\n    await supabase.auth.signOut();\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        login,\r\n        register,\r\n        logout,\r\n        loading,\r\n        updatePassword, // ‚Üê agregado al contexto\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error(\"useAuth must be used inside AuthProvider\");\r\n  return ctx;\r\n};\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;AAHA;;;AAwBA,MAAM,4BAAc,IAAA,8KAAa,EAA0B;AAEpD,MAAM,eAAe,CAAC,EAAE,QAAQ,EAAiC;;IACtE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAM;IACtC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,2BAA2B;IAC3B,IAAA,0KAAS;kCAAC;YACR,MAAM;qDAAa;oBACjB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,qIAAQ,CAAC,IAAI,CAAC,UAAU;oBAC/C,QAAQ,KAAK,OAAO,EAAE,QAAQ;oBAC9B,WAAW;gBACb;;YAEA;YAEA,gCAAgC;YAChC,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,qIAAQ,CAAC,IAAI,CAAC,iBAAiB;0CACxD,CAAC,QAAyB;oBACxB,QAAQ,SAAS,QAAQ;gBAC3B;;YAGF;0CAAO,IAAM,SAAS,YAAY,CAAC,WAAW;;QAChD;iCAAG,EAAE;IAEL,QAAQ;IACR,MAAM,QAAQ,OAAO,OAAe;QAClC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,qIAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC;YAC7D;YACA;QACF;QAEA,IAAI,OAAO;YACT,OAAO;gBAAE,SAAS;gBAAO,SAAS,MAAM,OAAO;YAAC;QAClD;QAEA,OAAO;YAAE,SAAS;YAAM,MAAM,KAAK,IAAI;QAAC;IAC1C;IAEA,WAAW;IACX,MAAM,WAAW,OAAO,EACtB,KAAK,EACL,QAAQ,EACR,UAAU,EACV,SAAS,EACT,QAAQ,EACR,KAAK,EACW;QAChB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,qIAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;YACjD;YACA;YACA,SAAS;gBACP,MAAM;oBACJ;oBACA;oBACA,OAAO,SAAS;gBAClB;YACF;QACF;QAEA,IAAI,OAAO;YACT,OAAO;gBAAE,SAAS;gBAAO,SAAS,MAAM,OAAO;YAAC;QAClD;QAEA,OAAO;YAAE,SAAS;YAAM,MAAM,KAAK,IAAI;QAAC;IAC1C;IAEA,kBAAkB;IAClB,MAAM,iBAAiB,OAAO;QAC5B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,qIAAQ,CAAC,IAAI,CAAC,UAAU,CAAC;YACrD,UAAU;QACZ;QAEA,IAAI,OAAO;YACT,OAAO;gBAAE,SAAS;gBAAO,SAAS,MAAM,OAAO;YAAC;QAClD;QAEA,OAAO;YAAE,SAAS;YAAM,MAAM,KAAK,IAAI;QAAC;IAC1C;IAEA,SAAS;IACT,MAAM,SAAS;QACb,MAAM,qIAAQ,CAAC,IAAI,CAAC,OAAO;IAC7B;IAEA,qBACE,6LAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;GAlGa;KAAA;AAoGN,MAAM,UAAU;;IACrB,MAAM,MAAM,IAAA,2KAAU,EAAC;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT;IAJa"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ginos/Desktop/PRODUCTION/underTangoWeb/app/Android-module/FCM/FcmRegistration.tsx"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport { getMessaging, getToken, isSupported } from \"firebase/messaging\";\r\nimport { getFirestore, doc, setDoc } from \"firebase/firestore\";\r\nimport { useEffect } from \"react\";\r\n\r\nconst firebaseConfig = {\r\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY!,\r\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID!,\r\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID!,\r\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID!,\r\n};\r\n\r\nconst VAPID_KEY = process.env.NEXT_PUBLIC_VAPID_KEY!;\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nconst db = getFirestore(app);\r\n\r\nasync function storeFCMToken(token: string) {\r\n    try {\r\n        await setDoc(doc(db, \"fcmTokens\", token), {\r\n            token,\r\n            platform: navigator.platform,\r\n            timestamp: new Date().toISOString(),\r\n        });\r\n        console.log(\"Token guardado en Firestore\");\r\n    } catch (e) {\r\n        console.error(\"Error guardando token:\", e);\r\n    }\r\n}\r\n\r\nasync function handleFCMRegistration() {\r\n    if (!(await isSupported())) {\r\n        console.warn(\"FCM no soportado.\");\r\n        return;\r\n    }\r\n\r\n    try {\r\n        const messaging = getMessaging(app);\r\n\r\n        const permission = await Notification.requestPermission();\r\n        if (permission !== \"granted\") {\r\n            console.warn(\"Permiso denegado\");\r\n            return;\r\n        }\r\n\r\n        console.log(\"Permiso concedido\");\r\n\r\n        // üëâ Registrar SOLO firebase-messaging-sw.js\r\n        const fcmRegistration = await navigator.serviceWorker.register(\r\n            \"/firebase-messaging-sw.js\", { type: \"module\" }\r\n        );\r\n\r\n        console.log(\"SW de Firebase registrado\");\r\n\r\n        // üëâ Obtener token usando ese service worker\r\n        const token = await getToken(messaging, {\r\n            vapidKey: VAPID_KEY,\r\n            serviceWorkerRegistration: fcmRegistration,\r\n        });\r\n\r\n        if (!token) {\r\n            console.warn(\"Token no generado\");\r\n            return;\r\n        }\r\n\r\n        console.log(\"Token generado:\", token);\r\n\r\n        await storeFCMToken(token);\r\n    } catch (error) {\r\n        console.error(\"Error al registrar FCM:\", error);\r\n    }\r\n}\r\n\r\nexport default function FcmRegistration() {\r\n    useEffect(() => {\r\n        handleFCMRegistration();\r\n    }, []);\r\n\r\n    return null;\r\n}\r\n"],"names":[],"mappings":";;;;AAMY;AANZ;AAAA;AACA;AAAA;AACA;AAAA;AACA;;;;;;AAEA,MAAM,iBAAiB;IACnB,MAAM;IACN,SAAS;IACT,iBAAiB;IACjB,KAAK;AACT;AAEA,MAAM;AAEN,MAAM,MAAM,IAAA,oLAAa,EAAC;AAC1B,MAAM,KAAK,IAAA,kLAAY,EAAC;AAExB,eAAe,cAAc,KAAa;IACtC,IAAI;QACA,MAAM,IAAA,4KAAM,EAAC,IAAA,yKAAG,EAAC,IAAI,aAAa,QAAQ;YACtC;YACA,UAAU,UAAU,QAAQ;YAC5B,WAAW,IAAI,OAAO,WAAW;QACrC;QACA,QAAQ,GAAG,CAAC;IAChB,EAAE,OAAO,GAAG;QACR,QAAQ,KAAK,CAAC,0BAA0B;IAC5C;AACJ;AAEA,eAAe;IACX,IAAI,CAAE,MAAM,IAAA,wLAAW,KAAK;QACxB,QAAQ,IAAI,CAAC;QACb;IACJ;IAEA,IAAI;QACA,MAAM,YAAY,IAAA,yLAAY,EAAC;QAE/B,MAAM,aAAa,MAAM,aAAa,iBAAiB;QACvD,IAAI,eAAe,WAAW;YAC1B,QAAQ,IAAI,CAAC;YACb;QACJ;QAEA,QAAQ,GAAG,CAAC;QAEZ,6CAA6C;QAC7C,MAAM,kBAAkB,MAAM,UAAU,aAAa,CAAC,QAAQ,CAC1D,6BAA6B;YAAE,MAAM;QAAS;QAGlD,QAAQ,GAAG,CAAC;QAEZ,6CAA6C;QAC7C,MAAM,QAAQ,MAAM,IAAA,qLAAQ,EAAC,WAAW;YACpC,UAAU;YACV,2BAA2B;QAC/B;QAEA,IAAI,CAAC,OAAO;YACR,QAAQ,IAAI,CAAC;YACb;QACJ;QAEA,QAAQ,GAAG,CAAC,mBAAmB;QAE/B,MAAM,cAAc;IACxB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;IAC7C;AACJ;AAEe,SAAS;;IACpB,IAAA,0KAAS;qCAAC;YACN;QACJ;oCAAG,EAAE;IAEL,OAAO;AACX;GANwB;KAAA"}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ginos/Desktop/PRODUCTION/underTangoWeb/app/Android-module/PWAServiceWorker.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\nimport FcmRegistration from \"./FCM/FcmRegistration\";\r\n\r\nexport default function PWAServiceWorker() {\r\n  useEffect(() => {\r\n    if (\"serviceWorker\" in navigator) {\r\n      window.addEventListener(\"load\", () => {\r\n        // 1) Service Worker general (scope \"/\")\r\n        navigator.serviceWorker\r\n          .register(\"/sw.js\")\r\n          .then((reg) => {\r\n            console.log(\"SW general registrado:\", reg.scope);\r\n          })\r\n          .catch((err) => console.error(\"Error registrando sw.js:\", err));\r\n\r\n        // 2) Service Worker de Firebase (scope \"/firebase/\")\r\n        navigator.serviceWorker\r\n          .register(\"/firebase/firebase-messaging-sw.js\", {\r\n            scope: \"/firebase/\",\r\n          })\r\n          .then((reg) => {\r\n            console.log(\"SW Firebase registrado:\", reg.scope);\r\n          })\r\n          .catch((err) =>\r\n            console.error(\"Error registrando firebase-messaging-sw.js:\", err)\r\n          );\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {/* \r\n        üöÄ Renderizar FcmRegistration dispara su useEffect:\r\n        1. Inicializa Firebase.\r\n        2. Solicita permiso de notificaci√≥n.\r\n        3. Obtiene el token FCM.\r\n        4. Lo env√≠a al backend / Cloud Function.\r\n      */}\r\n      <FcmRegistration />\r\n\r\n      {null}\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKe,SAAS;;IACtB,IAAA,0KAAS;sCAAC;YACR,IAAI,mBAAmB,WAAW;gBAChC,OAAO,gBAAgB,CAAC;kDAAQ;wBAC9B,wCAAwC;wBACxC,UAAU,aAAa,CACpB,QAAQ,CAAC,UACT,IAAI;0DAAC,CAAC;gCACL,QAAQ,GAAG,CAAC,0BAA0B,IAAI,KAAK;4BACjD;yDACC,KAAK;0DAAC,CAAC,MAAQ,QAAQ,KAAK,CAAC,4BAA4B;;wBAE5D,qDAAqD;wBACrD,UAAU,aAAa,CACpB,QAAQ,CAAC,sCAAsC;4BAC9C,OAAO;wBACT,GACC,IAAI;0DAAC,CAAC;gCACL,QAAQ,GAAG,CAAC,2BAA2B,IAAI,KAAK;4BAClD;yDACC,KAAK;0DAAC,CAAC,MACN,QAAQ,KAAK,CAAC,+CAA+C;;oBAEnE;;YACF;QACF;qCAAG,EAAE;IAEL,qBACE;;0BAQE,6LAAC,iKAAe;;;;;YAEf;;;AAGP;GAzCwB;KAAA"}}]
}